<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Cen√°rios em BDD</title>
    <style>
        /* Estilos CSS */
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #eef1f5;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        .container {
            background-color: #ffffff;
            padding: 25px 35px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 750px;
            box-sizing: border-box;
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.8em;
        }

        h2 {
            color: #34495e;
            margin-top: 30px;
            border-bottom: 2px solid #bdc3c7;
            padding-bottom: 8px;
            font-size: 1.4em;
        }

        p, label {
            margin-bottom: 10px;
            color: #555;
            font-size: 0.95em;
        }

        .input-section label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #34495e;
        }

        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 1em;
            margin-bottom: 20px;
            box-sizing: border-box;
            min-height: 100px;
            resize: vertical;
        }

        textarea:focus {
            border-color: #3498db;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
            outline: none;
        }

        button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 25px;
            text-align: center;
            text-decoration: none;
            display: block;
            width: 100%;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            position: relative; /* Para o spinner */
        }

        button:hover {
            background: linear-gradient(135deg, #2980b9, #3498db);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }
        
        button:active {
            transform: translateY(0px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        button.loading .button-text {
            visibility: hidden;
        }

        button .spinner {
            visibility: hidden;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            position: absolute;
            top: 50%;
            left: 50%;
            margin-top: -10px;
            margin-left: -10px;
        }

        button.loading .spinner {
            visibility: visible;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .output-section {
            margin-top: 30px;
        }

        #outputText {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            min-height: 150px; 
            border: 1px solid #e0e0e0;
            white-space: pre-wrap; 
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.95em;
            line-height: 1.5; 
            text-align: left; 
        }

        #outputText .placeholder {
            color: #888;
            font-style: italic;
            font-family: 'Arial', sans-serif;
        }
        
        .error-message {
            color: #c0392b; 
            background-color: #fdecea;
            border: 1px solid #e74c3c;
            padding: 10px;
            border-radius: 5px;
            margin-top: 15px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìù Gerador de Cen√°rios em BDD</h1>
        <p>Descreva seu cen√°rio de teste em linguagem natural. Esta ferramenta ajudar√° a estrutur√°-lo no formato Gherkin.</p>

        <div class="input-section">
            <label for="inputText">Descri√ß√£o do Cen√°rio:</label>
            <textarea id="inputText" rows="5" placeholder="Ex: O usu√°rio acessa a tela de login, informa credenciais v√°lidas e clica em entrar, ent√£o √© redirecionado para o painel."></textarea>
        </div>

        <button id="generateButton">
            <span class="button-text">‚ú® Gerar Cen√°rio</span>
            <div class="spinner"></div>
        </button>
        <div id="errorMessage" class="error-message" style="display: none;"></div>


        <div class="output-section">
            <h2>Resultado Gerado:</h2>
            <pre id="outputText"><p class="placeholder">Seu cen√°rio formatado aparecer√° aqui...</p></pre>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const inputTextElement = document.getElementById('inputText');
            const generateButtonElement = document.getElementById('generateButton');
            const buttonTextElement = generateButtonElement.querySelector('.button-text');
            const outputTextElement = document.getElementById('outputText'); 
            const errorMessageDivElement = document.getElementById('errorMessage');

            function showError(message) {
                errorMessageDivElement.textContent = message;
                errorMessageDivElement.style.display = 'block';
                outputTextElement.innerHTML = '<p class="placeholder">Falha ao gerar cen√°rio.</p>';
            }

            function clearError() {
                errorMessageDivElement.textContent = '';
                errorMessageDivElement.style.display = 'none';
            }
            
            generateButtonElement.addEventListener('click', async () => {
                const userInput = inputTextElement.value.trim();
                if (userInput === "") {
                    showError('Por favor, insira uma descri√ß√£o do cen√°rio.');
                    return;
                }

                clearError();
                generateButtonElement.classList.add('loading');
                buttonTextElement.textContent = 'Processando...'; 
                outputTextElement.innerHTML = '<p class="placeholder">Aguarde, gerando o cen√°rio...</p>';

                const systemPrompt = `Voc√™ √© um assistente especializado em Behavior-Driven Development (BDD) e Gherkin.
Sua tarefa √© transformar uma descri√ß√£o de cen√°rio de teste em linguagem natural fornecida pelo usu√°rio em um cen√°rio BDD bem estruturado, no formato Gherkin, em Portugu√™s do Brasil.
O resultado deve ser TEXTO PURO, pronto para exibi√ß√£o, com a indenta√ß√£o correta (2 espa√ßos para cada n√≠vel aninhado de Dado/Quando/Ent√£o/E) e sem tags HTML.

**IMPORTANTE: Adapte o n√≠vel de detalhe, a fraseologia e a perspectiva (primeira ou terceira pessoa) do cen√°rio Gherkin √† complexidade e ao estilo da entrada do usu√°rio. Al√©m disso, CORRIJA erros de ortografia e gram√°tica em portugu√™s presentes na entrada do usu√°rio ao gerar os passos do cen√°rio.**

* **Para entradas CURTAS e DIRETAS (1-3 frases simples):**
    * Gere um cen√°rio CONCISO e DIRETO.
    * **T√≠tulo do Cen√°rio (\`Cen√°rio:\`):** Deve ser uma descri√ß√£o CURTA e FOCADA NO OBJETIVO PRINCIPAL da sequ√™ncia de a√ß√µes, em vez de listar todas as a√ß√µes. Se o usu√°rio descreve um fluxo (ex: entrar, cadastrar, comprar), o t√≠tulo deve resumir esse fluxo (ex: "Efetuar compra ap√≥s cadastro"). Use palavras-chave da entrada do usu√°rio para formar este t√≠tulo conciso.
    * Os passos \`Dado\`, \`Quando\`, \`Ent√£o\`, \`E\` devem refletir MUITO DE PERTO a fraseologia e a perspectiva (primeira pessoa, se usada) do usu√°rio, AP√ìS A CORRE√á√ÉO ORTOGR√ÅFICA/GRAMATICAL. Evite adicionar palavras, formalismos ou detalhes n√£o expl√≠citos. Mantenha a simplicidade.
* **Para entradas MAIS LONGAS e DESCRITIVAS, ou que n√£o usam primeira pessoa:**
    * Voc√™ pode elaborar mais, inferir pr√©-condi√ß√µes, usar uma perspectiva mais formal (terceira pessoa ou impessoal, ex: "O usu√°rio...", "O sistema..."), adicionar exemplos de dados concretos (entre aspas) e m√∫ltiplas verifica√ß√µes, conforme o exemplo mais longo abaixo. O t√≠tulo do cen√°rio ainda deve buscar ser representativo do objetivo geral.

**Estilo e Concord√¢ncia para BDD em Portugu√™s:**
* Mantenha a concord√¢ncia verbal e nominal correta.
* Use frases claras e objetivas.
* Palavras-chave Gherkin em portugu√™s: \`Cen√°rio:\`, \`Dado\`, \`Quando\`, \`Ent√£o\`, \`E\`, \`Mas\`. Priorize o uso destas palavras-chave no output.

---
Exemplo de Transforma√ß√£o (ENTRADA CURTA, foco em T√çTULO CONCISO e fraseologia do usu√°rio):

Entrada do Usu√°rio:
Entro no app, me cadastro, fa√ßo uma compra e incluio no carrinho depois valido o carrinho

Sa√≠da Esperada (TEXTO PURO, Gherkin com t√≠tulo conciso):
Cen√°rio: Efetuar compra e validar carrinho no app
  Dado que eu entro no app
  Quando me cadastro
  E fa√ßo uma compra
  E incluo no carrinho
  Ent√£o valido o carrinho
---
Exemplo de Transforma√ß√£o (ENTRADA CURTA, primeira pessoa, com erro ortogr√°fico - FOCO EM CORRE√á√ÉO, SIMPLICIDADE E FRASEOLOGIA DO USU√ÅRIO):

Entrada do Usu√°rio:
Entro no site do reclame aqui, incluio uma mensagem de reclama√ß√£o e depois valido se a mensagem foi postaasd

Sa√≠da Esperada (TEXTO PURO, Gherkin conciso, direto E CORRIGIDO):
Cen√°rio: Postar e validar reclama√ß√£o no Reclame Aqui
  Dado que eu entro no site do Reclame Aqui
  Quando incluo uma mensagem de reclama√ß√£o
  Ent√£o valido se a mensagem foi postada
---
Exemplo de Transforma√ß√£o (ENTRADA CURTA, primeira pessoa - FOCO EM SIMPLICIDADE E FRASEOLOGIA DO USU√ÅRIO):

Entrada do Usu√°rio:
Entro no APP e me cadastro ent√£o valido o cadastro

Sa√≠da Esperada (TEXTO PURO, Gherkin conciso e direto):
Cen√°rio: Cadastrar e validar no app
  Dado eu entro no app
  E fa√ßo um cadastro no app
  Ent√£o valido o meu cadastro
---
Exemplo de Transforma√ß√£o (ENTRADA CURTA, primeira pessoa, com detalhes espec√≠ficos - FOCO EM SIMPLICIDADE E FRASEOLOGIA DO USU√ÅRIO):

Entrada do Usu√°rio:
eu logo com um usuario, fa√ßo um pix com a chave QRCode Copia e Cola e ent√£o deve ser apresentada a mensagem de "Pix realizado com sucesso!" e deve aparecer o comprovante na tela

Sa√≠da Esperada (TEXTO PURO, Gherkin conciso e direto):
Cen√°rio: Realizar Pix com QRCode Copia e Cola e verificar comprovante
  Dado que eu logo com um usuario
  Quando fa√ßo um pix com a chave QRCode Copia e Cola
  Ent√£o deve ser apresentada a mensagem de "Pix realizado com sucesso!"
  E deve aparecer o comprovante na tela
---
Exemplo de Transforma√ß√£o (ENTRADA CURTA, primeira pessoa, mais simples - FOCO EM SIMPLICIDADE E FRASEOLOGIA DO USU√ÅRIO):

Entrada do Usu√°rio:
Entro no app, crio uma conta e fa√ßo um pix, valido o pix

Sa√≠da Esperada (TEXTO PURO, Gherkin conciso e direto):
Cen√°rio: Criar conta, fazer e validar pix no app
  Dado eu entro no app
  Quando crio uma conta
  E fa√ßo um pix
  Ent√£o valido o pix
---
Exemplo de Transforma√ß√£o (ENTRADA MAIS DESCRITIVA, perspectiva de terceira pessoa impl√≠cita):

Entrada do Usu√°rio:
O cooperado loga no app, inclui o unitoken e altera o limite e valida se o limite foi alterado

Sa√≠da Esperada (TEXTO PURO, Gherkin detalhado, terceira pessoa):
Cen√°rio: Cooperado altera limite com sucesso ap√≥s login e valida√ß√£o de unitoken
  Dado que o cooperado possui credenciais de acesso v√°lidas
  E o cooperado est√° na tela de login do aplicativo
  E o cooperado possui um unitoken ativo e v√°lido para uso
  Quando ele informa suas credenciais (usu√°rio e senha) e clica no bot√£o "Entrar"
  E ele insere o c√≥digo do unitoken quando solicitado
  E ele navega para a funcionalidade de "Altera√ß√£o de Limites"
  E ele informa o novo valor de limite desejado como "R$ 5.000,00"
  E ele confirma a opera√ß√£o de altera√ß√£o de limite
  Ent√£o o sistema deve exibir a mensagem de confirma√ß√£o "Limite atualizado com sucesso!"
  E ao consultar o detalhe do limite, o valor exibido deve ser "R$ 5.000,00"
  E o sistema deve registrar um log da altera√ß√£o de limite para o cooperado
---

Agora, transforme a seguinte entrada do usu√°rio em TEXTO PURO Gherkin, adaptando o n√≠vel de detalhe, a fraseologia, a perspectiva, E CORRIGINDO ERROS DE ORTOGRAFIA/GRAM√ÅTICA EM PORTUGU√äS, e gerando um T√çTULO DE CEN√ÅRIO CONCISO E FOCO NO OBJETIVO PRINCIPAL, conforme a complexidade da entrada e os exemplos fornecidos:
"${userInput}"`;

                // ATEN√á√ÉO M√ÅXIMA: RISCO DE SEGURAN√áA AO COLOCAR CHAVES DE API DIRETAMENTE NO C√ìDIGO DO CLIENTE!
                // Esta linha √© onde voc√™ colocaria sua chave de API Gemini se estivesse testando localmente
                // ou se estivesse disposto a correr o risco EXTREMO de exp√¥-la publicamente no GitHub Pages.
                // N√ÉO FA√áA ISSO EM UM REPOSIT√ìRIO P√öBLICO PARA PRODU√á√ÉO OU USO PROLONGADO.
                // SUA CHAVE SER√Å ROUBADA E USADA INDEVIDAMENTE.
                // Para testes MUITO r√°pidos e limitados, e se voc√™ remover a chave IMEDIATAMENTE DEPOIS:
                const apiKey = "AIzaSyBFf-iK9nmxS-G80X8kYLlTgkKgJUUSsH4"; // CHAVE FORNECIDA PELO USU√ÅRIO - RISCO DE SEGURAN√áA!

                // Verifica√ß√£o para alertar se a chave placeholder ainda estiver l√° (embora agora estejamos usando a chave fornecida)
                if (apiKey === "SUA_CHAVE_API_GEMINI_AQUI" || apiKey === "") {
                    showError("Chave de API n√£o configurada corretamente no c√≥digo. A funcionalidade de gera√ß√£o n√£o funcionar√°.");
                    generateButtonElement.classList.remove('loading');
                    buttonTextElement.textContent = '‚ú® Gerar Cen√°rio';
                    return;
                }
                
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                
                let chatHistory = [{ role: "user", parts: [{ text: systemPrompt }] }];
                const payload = { contents: chatHistory };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        console.error('Erro da API:', errorData);
                        throw new Error(`Falha na API: ${errorData.error?.message || response.statusText}`);
                    }

                    const result = await response.json();
                    
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const aiResponseText = result.candidates[0].content.parts[0].text;
                        outputTextElement.textContent = aiResponseText; 
                    } else {
                        console.error('Resposta inesperada da ferramenta:', result);
                        throw new Error('N√£o foi poss√≠vel obter uma resposta v√°lida da ferramenta de formata√ß√£o.');
                    }

                } catch (error) { 
                    console.error('Erro ao chamar a ferramenta de formata√ß√£o:', error);
                    showError(`Erro ao processar: ${error.message}. Verifique o console para mais detalhes.`);
                } finally {
                    generateButtonElement.classList.remove('loading');
                    buttonTextElement.textContent = '‚ú® Gerar Cen√°rio'; 
                }
            });
        });
    </script>
</body>
</html>
